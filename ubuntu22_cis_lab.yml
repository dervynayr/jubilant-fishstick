---
- name: Ubuntu 22 CIS Hardening - Lab Safe
  hosts: all
  become: yes
  gather_facts: yes
  ubtu22cis_grub_user: root
  ubtu22cis_grub_password: "grub.pbkdf2.sha512.10000.grub.pbkdf2.sha512.10000.9ECAA52CFD4757726BA56EB4A243931CE7333D20C5A5FCE3807C3C58AD0ABD18732888693FCCAC01113909E4A247FB05D04004531738FCF537A228FF3386F318.298077D5F34CD0449B02B3E985CB02F578296DBD57D010874C92F848E25BDC610DC58CA433A3BA79821AA988C1D390BAC020CD9EA8981570F816950901DD4359"

  vars:
    # Skip GRUB hardening to avoid blocking boot
    ubtu22cis_skip_grub: true

    # Keep SSH accessible
    ubtu22cis_ssh_lockdown: false

  tasks:

    - name: Run UBUNTU22-CIS Role
      include_role:
        name: UBUNTU22-CIS
      ignore_errors: yes   # Continue even if individual tasks fail

    - name: Report failed tasks for this host
      debug:
        msg: "Some tasks may have failed. Check previous logs for details."
